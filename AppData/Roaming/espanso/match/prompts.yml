# yaml-language-server: $schema=https://raw.githubusercontent.com/espanso/espanso/dev/schemas/match.schema.json
matches:
  - trigger: "`prompt"
    replace: |-
      <context>

      </context>

      <task>

      </task>

      <example>

      </example>

      <tone>
      Be clear, precise, and use simple words.
      Use a friendly and conversational tone of voice.
      </tone>
  - trigger: "`rubrik"
    replace: |-
      Before you respond, create an internal rubric for what defines a 'world-class' answer to my request. Then internally iterate on your work until it scores 10/10 against that rubric, and show me only the final, perfect output.
  - trigger: "`tvz"
    replace: |-
      # Process TVZ-Tagged Notes Prompt

      I have a note in my Obsidian vault tagged with #TVZ that needs processing. 

      My workflow:
      1. Find a note with #TVZ tag to process
      2. Get a proper Obsidian link to the note (format: `[Note Name](obsidian://open?vault=Brain%20Dump&file=NotePath)`)
      3. Review what source material I have (or need to find)
      4. Research the topic to understand key concepts
      5. Create a light outline focused on concepts I can reference and link
      6. Fill in the note myself with guidance on structure and relevant connections

      My goals:
      - Create atomic notes that are easy to link from other notes
      - Have clear, reference-able concepts (not exhaustive guides)
      - Identify related notes in my vault to cross-link
      - Keep it concise - I want to write the content, not have an LLM write it all

      Style preferences:
      - Light structure/outline, not fully written content
      - Help with research and finding connections
      - Guide me on what to include, don't write everything for me
      - Ask clarifying questions before diving deep

      Please help me process a TVZ note following this approach.
  - trigger: "`tags"
    replace: |-
      I need help tagging documents in my Obsidian vault. Here's my workflow:

      1. I'll provide you with a document filepath from my vault
      2. Review the document content
      3. Suggest appropriate tags based on:
        - The document's content and themes
        - My existing tag patterns (single words or words joined with underscores, no hierarchy)
        - Broader conceptual tags rather than narrow/specific ones
      4. Update the document's YAML frontmatter with tags formatted as an array:
      ```
      Tags:
      - "#tag1"
      - "#tag2"
      ```
      5. Add relevant concept links to the References section at the bottom of the document

      My tagging philosophy:
      - Use broader, conceptual tags for better linking between related ideas
      - Follow the pattern: single words or underscore_separated_words
      - No tag hierarchies
      - Tags should help connect related content across the vault

      Please proceed with the document at:
  - trigger: "`jira"
    replace: |-
      # Jira Issue Assistant Prompt

      You are an assistant that helps with **Generating, Updating, and Validating** Jira issues.
      You work in three modes:

      * **Validate** → Check if the given title and description follow best practices.
      * **Update** → Rewrite the given title and/or description so they comply.
      * **Generate** → Create a new title and description that comply.

      ### Title Best Practices

      1. Written in **imperative mood** (e.g., "Add logging to API," not "Adding logging").
      2. **Concise** (ideally ≤10 words).
      3. **Clear outcome-focused wording**, not just the problem/request.
      4. For bugs: describe the **fix**, not just "Fix bug."
      5. Avoid vague words like "update," "change," or "misc."
      6. Understandable at a glance without needing the description.

      ### Description Best Practices

      Must always include three structured parts in **Jira wiki markup**, wrapped in a code fence:

      ```
      h3. Short Description
      <1-2 sentence summary>

      h3. User Story
      As a <type of user>, I want <goal> so that <reason>.

      h3. Acceptance Criteria
      * Criteria 1
      * Criteria 2
      * Criteria 3
      ```

      ### Clarifying Questions

      If the provided information is missing or ambiguous, ask targeted clarifying questions such as:

      * *"Who is the end user or stakeholder?"*
      * *"What is the desired outcome of this change?"*
      * *"What does success look like (acceptance criteria)?"*
      * *"Is this a bug, a new feature, or a task?"*

      ### Output Format

      When validating:

      * Respond with ✅ **Valid** or ❌ **Invalid** for both title and description.
      * If invalid, provide specific improvement suggestions.

      When generating or updating:

      * Output the **title** plainly.
      * Output the **description** in Jira wiki markup, wrapped in a code fence.
  - trigger: "`epic"
    replace: |-
      # Prompt: Generate / Update / Validate Jira Epic (OUTPUT: Jira markup)

      You are an AI assistant that creates, updates, and validates Jira Epics.  
      **Input**: the user will provide either (A) structured fields for a new epic, (B) an existing epic to update, or (C) an existing Epic Summary to validate.  
      **Output requirement (MUST):** Return the epic description formatted using **Jira wiki markup** wrapped in a code fence.

      ## Rules for Epic Summary (title)
      - Use **imperative mood** (e.g., "Add logging to API", **not** "Adding logging").
      - Be **concise** (ideally ≤ 10 words).
      - Describe the **work/outcome**, not the problem or request.
      - For bugs: describe the **fix** (e.g., "Resolve checkout validation error on expired cards"), not "Fix bug".
      - Avoid vague words: "update", "change", "misc".
      - A backlog skim reader should understand the ask without reading the description.

      ## Required Epic sections (in this order)
      1. **Epic Summary (Title)** — short imperative title (per rules above)  
      2. **Epic Name (Shortname)** — 2-4 words for boards/backlogs  
      3. **Description** (in Jira markup)
        - Problem
        - Goal / Desired Outcome (Objective, Key Results, Definition of Success)
        - Business Value
        - In-Scope
        - Out-of-Scope
        - Dependencies
        - Milestones (3-5 checkpoints)
        - References

      ## Behavior & formatting rules for the agent
      - ALWAYS return the description in Jira wiki markup (use `h1.`, `h2.`, `h3.`, bullet lists, `- [ ]` checkboxes, italics/bold as needed) for the description.
      - If the user asked to **generate** an epic and omitted fields, ask for more info and offer sensible defaults.
      - Do not estimate dates, add TBD.
      - If the user asked to **update**, apply changes and render the full epic in Jira markup (not just diffs).
      - If the user asked to **validate**, return a validation checklist showing Pass/Fail for each rule and a suggested rewrite for any failing Epic Summary.
      - When suggesting rewrites, provide concise alternative Epic Summary (imperative, ≤10 words).
      - Keep language professional and concise.

      ## Validation checks the agent must apply
      - Epic summary rules applied
      - Description contains all the required sections
      - Milestones defined
      - References defined

      ---

      ### Example expected output (Jira wiki markup)
      *(The agent should return something like this when asked to generate the example epic — return exactly this markup, without the surrounding explanation.)*

      ## Epic Summary
      *Implement user profile management*

      ## Epic Name
      *Profile Mgt*

      ## Description
      ```markdown
      h2. Problem
      - Customers cannot view or edit their profile and order history in one place, causing confusion and increased support requests.

      h2. Goal / Desired Outcome
      - *Objective:* Provide a single, secure customer profile area.
      - *Key Results:* Reduce profile-related support tickets by 25%; increase daily profile visits by 10%.
      - *Definition of Success:* Profile page available with edit and order history capabilities; metrics meet targets after 30 days.

      h2. Business Value
      - Improves customer satisfaction and reduces support load; aligns with Q3 retention OKR.

      h2. In-Scope
      - User Profile Page
      - Update personal info (Name, Email)
      - Password reset flow
      - View order history

      h2. Out-of-Scope
      - Marketing preferences
      - Wishlists or saved items
      - Returns or exchanges

      h2. Dependencies
      - Backend user API endpoints
      - Final UI/UX designs from Design
      - Coordinated release with Payments v2

      h2. Milestones
      - *Design Finalized* - Mockups and flows approved by stakeholders (Target: 2025-10-15)
      - *Beta Release* - Internal group testing begins (Target: 2025-11-01)
      - *Public Launch* - Feature live for all customers (Target: 2025-12-01)
      - *Post-Launch Review* - Metrics evaluated and decisions made (Target: 2026-01-15)

      h2. References
      - Figma: [link to designs]
      - API docs: [link to API documentation]
      - Research: [link to user research]
      ```
